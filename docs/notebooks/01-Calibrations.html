

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>01-Calibration &mdash; sara-spec  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="sara-spec" href="../API.html" />
    <link rel="prev" title="Welcome to sara-spec documentation!" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> sara-spec
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Notebooks:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">01-Calibration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#The-Following-Cell-will-create-the-directory-for-all-the-files-created-in-this-notebook-if-it-does-nto-already-exist">The Following Cell will create the directory for all the files created in this notebook if it does nto already exist</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Set-the-path-to-where-the-data-is-on-your-computer-(or-Google-Drive)">Set the path to where the data is on your computer (or Google Drive)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#1.-Bias-images">1. Bias images</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#1.a-The-cell-below-will-create-a-PDF-of-all-the-bias-images,-for-inspection">1.a The cell below will create a PDF of all the bias images, for inspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#The-cell-below-is-an-example-for-a-case-where-the-names-only-differ-by-a-number.">The cell below is an example for a case where the names only differ by a number.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#For-other-ways-to-create-arrays-of-names-in-more-complex-situations">For other ways to create arrays of names in more complex situations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#1.b-Now-that-you-have-inspected-all-the-biases,-make-a-finale-selection-below">1.b Now that you have inspected all the biases, make a finale selection below</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#2.-Darks">2. Darks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#2a.The-cell-below-will-create-a-PDF-of-all-the-dark-images,-for-inspection">2a.The cell below will create a PDF of all the dark images, for inspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#2.b-Now-that-you-have-inspected-all-the-darks,-make-a-finale-selection-below">2.b Now that you have inspected all the darks, make a finale selection below</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#3.-Flats">3. Flats</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.a-The-cell-below-will-create-a-PDF-of-all-the-FLATS-for-inspection">3.a The cell below will create a PDF of all the FLATS for inspection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.b-Now-that-you-have-inspected-all-the-flats,-as-long-as-they-are-okay,-make-a-finale-selection-below-and-create-Master-file-for-each-exposure-times">3.b Now that you have inspected all the flats, as long as they are okay, make a finale selection below and create Master file for each exposure times</a></li>
<li class="toctree-l3"><a class="reference internal" href="#4.-THARs">4. THARs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#4.a-The-cell-below-will-create-a-PDF-of-all-the-ThAr-for-inspection">4.a The cell below will create a PDF of all the ThAr for inspection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#5.b-Now-that-you-have-inspected-all-the-ThArs,-as-long-as-they-are-okay,-make-a-finale-selection-below-and-create-Master-file">5.b Now that you have inspected all the ThArs, as long as they are okay, make a finale selection below and create Master file</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../API.html">sara-spec</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sara-spec</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>01-Calibration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/notebooks/01-Calibrations.nblink.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="01-Calibration">
<h1>01-Calibration<a class="headerlink" href="#01-Calibration" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Keefe changed Path to folder in the cell that makes the directory for the files 24 June 2020</span>
<span class="c1">#Keefe added the camera switch dates on 29 Jun 2020</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.ma</span> <span class="k">as</span> <span class="nn">ma</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_pdf</span> <span class="kn">import</span> <span class="n">PdfPages</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits</span> <span class="kn">import</span> <span class="n">mplot3d</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">find_peaks</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">modf</span>

<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">diags</span>
<span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">spsolve</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">csr_matrix</span>

<span class="kn">from</span> <span class="nn">astropy.convolution</span> <span class="kn">import</span> <span class="n">convolve</span><span class="p">,</span> <span class="n">Box1DKernel</span>

<span class="kn">from</span> <span class="nn">sara_spec</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="section" id="The-Following-Cell-will-create-the-directory-for-all-the-files-created-in-this-notebook-if-it-does-nto-already-exist">
<h2>The Following Cell will create the directory for all the files created in this notebook if it does nto already exist<a class="headerlink" href="#The-Following-Cell-will-create-the-directory-for-all-the-files-created-in-this-notebook-if-it-does-nto-already-exist" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># define the name of the directory to be created</span>
<span class="n">folder</span> <span class="o">=</span> <span class="s1">&#39;01-CalibrationMasters&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Creation of the directory </span><span class="si">%s</span><span class="s1"> failed (probably already exists&#39;</span> <span class="o">%</span> <span class="n">folder</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Successfully created the directory </span><span class="si">%s</span><span class="s1">&#39;</span>  <span class="o">%</span> <span class="n">folder</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Creation of the directory 01-CalibrationMasters failed (probably already exists
</pre></div></div>
</div>
<div class="section" id="Set-the-path-to-where-the-data-is-on-your-computer-(or-Google-Drive)">
<h3>Set the path to where the data is on your computer (or Google Drive)<a class="headerlink" href="#Set-the-path-to-where-the-data-is-on-your-computer-(or-Google-Drive)" title="Permalink to this headline">¶</a></h3>
<p>In the cell below, you create a variable “path” that contains the direction to the directory that contains the raw data.</p>
<p>We also set the dimension of the camera. * The variable “length” is in the dispersion direction (the long axis) * The variable “width” is in the cross-dispersion direction (the short axis)</p>
<p>The way the SARA data are encoded, the cross dispersion is the first dimention.</p>
<p>Thus a variable containing an image has dimension (510, 2108)</p>
<p>The region of the overscan (a small part of the detector that is not illuminated) is also defined here. Note that this changed with the camera switch. These regions are masked in the images – the best place to see it is the Dark. If there is a region of low light that appears on the edges, it may be that the overscan is not set to the correct value.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Example of path for the raw data, and or</span>
<span class="c1">#path = &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/Users/vpetit/Google Drive File Stream/Shared drives/REU2020-datasets/TestDataset/&#39;</span>


<span class="c1"># For SARA KP dates before the camera switch ie before 2019-09-18</span>
<span class="c1">#left = 10</span>
<span class="c1">#right = 2060</span>

<span class="c1"># For SARA KP dates after the camera switch ie after 2019-12-06</span>
<span class="n">left</span> <span class="o">=</span> <span class="mi">48</span>
<span class="n">right</span> <span class="o">=</span> <span class="mi">2098</span>

<span class="c1"># For the SARA KP camera</span>
<span class="n">length</span> <span class="o">=</span> <span class="mi">2108</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">510</span>

<span class="c1"># Saving the overscan and lenght values for later use.</span>
<span class="n">write_overscan</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>

<span class="c1">## VP moved to module</span>
<span class="c1"># np.savetxt( &#39;01-CalibrationMasters/overscan.dat&#39;, np.array([length, width, left, right], dtype=&#39;int&#39;).T )</span>

<span class="c1">## VP moved to module</span>
<span class="c1">#cmap = copy(plt.cm.Reds)</span>
<span class="c1">#cmap.set_bad(&#39;purple&#39;, 1.0) # the masked values are masked (the 1 is for the alpha)</span>

<span class="c1">#cmap_sat = copy(plt.cm.Reds)</span>
<span class="c1">#cmap_sat.set_over(&#39;green&#39;, 1.0)</span>
<span class="c1">#cmap_sat.set_under(&#39;blue&#39;, 1.0)</span>
<span class="c1">#cmap_sat.set_bad(&#39;purple&#39;, 1.0) # the masked values are masked (the 1 is for the alpha)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="1.-Bias-images">
<h3>1. Bias images<a class="headerlink" href="#1.-Bias-images" title="Permalink to this headline">¶</a></h3>
<p>The goal of this cell is to create an array of file names (including the path) in the variable “all_filename” which will be used in the next cell.</p>
</div>
</div>
<div class="section" id="1.a-The-cell-below-will-create-a-PDF-of-all-the-bias-images,-for-inspection">
<h2>1.a The cell below will create a PDF of all the bias images, for inspection<a class="headerlink" href="#1.a-The-cell-below-will-create-a-PDF-of-all-the-bias-images,-for-inspection" title="Permalink to this headline">¶</a></h2>
<p>The biases should look like this (you may have to add a scale factor in front of the “median”)</p>
<p>Note that the region of the overscan (in purple) may vary depending on when the data was taken</p>
<p>At the end of this cell, you will also have a graph of the median of each image. It should be constant.</p>
<p><img alt="ba62fb239b6e468e901a06c8c53b0e46" class="no-scaled-link" src="../_images/BiasExample.png" style="width: 600px;" /></p>
</div>
<div class="section" id="The-cell-below-is-an-example-for-a-case-where-the-names-only-differ-by-a-number.">
<h2>The cell below is an example for a case where the names only differ by a number.<a class="headerlink" href="#The-cell-below-is-an-example-for-a-case-where-the-names-only-differ-by-a-number." title="Permalink to this headline">¶</a></h2>
<p>In “image_number”, create an array with the number of the images that you want to check for the bias.</p>
<p>In the string adjust the name and format to match the filenames.</p>
</div>
<div class="section" id="For-other-ways-to-create-arrays-of-names-in-more-complex-situations">
<h2>For other ways to create arrays of names in more complex situations<a class="headerlink" href="#For-other-ways-to-create-arrays-of-names-in-more-complex-situations" title="Permalink to this headline">¶</a></h2>
<p>e.g. when the names differ by more than just numbers), see video tutorial</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##########</span>
<span class="c1"># Cell to change</span>
<span class="c1">##########</span>

<span class="n">image_number</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">image_number</span><span class="p">)</span>

<span class="n">all_filename</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/Bias/Bias-</span><span class="si">{:03}</span><span class="s1">.fit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">image_number</span><span class="p">]</span>

<span class="c1">#print(all_filename)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Nothing to change in this cell</span>

<span class="n">image_median</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">PdfPages</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/Bias.pdf&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pdf</span><span class="p">:</span>

    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">all_filename</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">data</span><span class="p">[:,</span><span class="n">right</span><span class="p">:</span><span class="n">length</span><span class="p">]</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                        <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">ma</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">ma</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">image_median</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="n">image_median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">image_median</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">image_median</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span><span class="o">*</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1">## Add labels to the figure below</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1248.6666666666667, 2824.5)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_01-Calibrations_10_1.png" src="../_images/notebooks_01-Calibrations_10_1.png" />
</div>
</div>
</div>
<div class="section" id="1.b-Now-that-you-have-inspected-all-the-biases,-make-a-finale-selection-below">
<h2>1.b Now that you have inspected all the biases, make a finale selection below<a class="headerlink" href="#1.b-Now-that-you-have-inspected-all-the-biases,-make-a-finale-selection-below" title="Permalink to this headline">¶</a></h2>
<p>The cell will use the list of filenames in “all_filename_final” to create the Master Bias.</p>
<p>The example here is constructed for names with only a different number. For more complex case, see the tutorials.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">output_name</span><span class="o">=</span><span class="s1">&#39;01-CalibrationMasters/MasterBias&#39;</span>

<span class="n">image_number_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">all_filename_final</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/Bias/Bias-</span><span class="si">{:03}</span><span class="s1">.fit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">image_number_final</span><span class="p">]</span>

<span class="c1">##############</span>
<span class="c1">##############</span>
<span class="c1"># Nothing to change below</span>


<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_filename_final</span><span class="p">),</span><span class="n">width</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_filename_final</span><span class="p">):</span>
    <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="mi">0</span><span class="p">:</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
    <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="n">right</span><span class="p">:</span><span class="n">length</span><span class="p">]</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

<span class="n">median_val</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">## remasking the array:</span>
<span class="n">median_val</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
<span class="n">median_val</span><span class="p">[:,</span><span class="n">right</span><span class="p">:</span><span class="n">length</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

<span class="n">median_val</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.dump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_name</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">median_val</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                <span class="n">vmin</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">median_val</span><span class="p">),</span><span class="n">vmax</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">median_val</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.colorbar.Colorbar at 0x7f94b7ce6ed0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_01-Calibrations_12_1.png" src="../_images/notebooks_01-Calibrations_12_1.png" />
</div>
</div>
<div class="section" id="2.-Darks">
<h3>2. Darks<a class="headerlink" href="#2.-Darks" title="Permalink to this headline">¶</a></h3>
<p>The darks should ultimately be grouped by exposure times.</p>
</div>
</div>
<div class="section" id="2a.The-cell-below-will-create-a-PDF-of-all-the-dark-images,-for-inspection">
<h2>2a.The cell below will create a PDF of all the dark images, for inspection<a class="headerlink" href="#2a.The-cell-below-will-create-a-PDF-of-all-the-dark-images,-for-inspection" title="Permalink to this headline">¶</a></h2>
<p>The darks should look like this (you may have to add a scale factor in front of the “median”)</p>
<p><img alt="7c203a3dc39c44fb98df763dbee445e2" class="no-scaled-link" src="../_images/DarkExample.png" style="width: 600px;" /></p>
<p>The goal of the cell below is to create a variable “all_filename” with the names of all the dark images</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##########</span>
<span class="c1"># Cell to change</span>
<span class="c1">##########</span>

<span class="n">image_number</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">image_number</span><span class="p">)</span>

<span class="n">all_filename</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/Dark/Dark-</span><span class="si">{:03}</span><span class="s1">.fit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">image_number</span><span class="p">]</span>

<span class="c1">#print(all_filename)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1 2 3 4 5]
</pre></div></div>
</div>
<p>The cell below will take your result and create the graphs</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Nothing to change in this cell</span>
<span class="n">image_median</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">PdfPages</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/Dark-all.pdf&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pdf</span><span class="p">:</span>

    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">all_filename</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="c1">#data[:,0:left] = ma.masked</span>
        <span class="c1">#data[:,right:length]=ma.masked</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                        <span class="n">vmin</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">ma</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">image_median</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="n">image_median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">image_median</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">image_median</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span><span class="o">*</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1">## Add labels to the figure below</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1664.0, 3756.0)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_01-Calibrations_18_1.png" src="../_images/notebooks_01-Calibrations_18_1.png" />
</div>
</div>
</div>
<div class="section" id="2.b-Now-that-you-have-inspected-all-the-darks,-make-a-finale-selection-below">
<h2>2.b Now that you have inspected all the darks, make a finale selection below<a class="headerlink" href="#2.b-Now-that-you-have-inspected-all-the-darks,-make-a-finale-selection-below" title="Permalink to this headline">¶</a></h2>
<p>Note: you will have to execute the cell below for each exposure time group.</p>
<p>Please add the exposure time in the output name for the dark.</p>
<p>Keep all of the commands you’ve use (commented out) for the records</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">output_name</span><span class="o">=</span><span class="s1">&#39;MasterDark-1800&#39;</span>
<span class="n">image_number_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">all_filename_final</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/Dark/Dark-</span><span class="si">{:03}</span><span class="s1">.fit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">image_number_final</span><span class="p">]</span>


<span class="c1">##############</span>
<span class="c1">##############</span>
<span class="c1"># Nothing to change below</span>

<span class="k">with</span> <span class="n">PdfPages</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_name</span><span class="p">))</span> <span class="k">as</span> <span class="n">pdf</span><span class="p">:</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_filename_final</span><span class="p">),</span><span class="n">width</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_filename_final</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="n">data</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">:</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">data</span><span class="p">[:,:,</span><span class="n">right</span><span class="p">:</span><span class="n">length</span><span class="p">]</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

    <span class="n">median_val</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1">## remasking the array:</span>
    <span class="n">median_val</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
    <span class="n">median_val</span><span class="p">[:,</span><span class="n">right</span><span class="p">:</span><span class="n">length</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

    <span class="n">median_val</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/</span><span class="si">{}</span><span class="s1">.dump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_name</span><span class="p">)</span> <span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">median_val</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                            <span class="n">vmin</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">median_val</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">median_val</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">ma</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">median_val</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">output_name</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

    <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1">#################</span>
    <span class="c1">#This part created an unmasked array for the dark database</span>

    <span class="c1"># Get the header of the first file in the list for the resulting fits file</span>
    <span class="n">header</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">all_filename_final</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># Reading the first file to get size</span>
    <span class="n">data1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">all_filename_final</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Create an empty array for subsequently taking the median</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_filename_final</span><span class="p">),</span> <span class="n">data1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="c1"># Create an empty array for the median of each images (to make sure everything is OK)</span>
    <span class="n">image_median</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_filename_final</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">data1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="mi">1000</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">image_median</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

    <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Calculate the median image</span>
    <span class="n">median_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Writting the file as fits</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span> <span class="s1">&#39;01-CalibrationMasters/</span><span class="si">{}</span><span class="s1">.fits&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_name</span><span class="p">),</span> <span class="n">median_val</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>

    <span class="c1"># Make a graph of the median of each images</span>
    <span class="n">image_median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">image_median</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">image_median</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span><span class="o">*</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Image #&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Image median&#39;</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


    <span class="c1"># Make an image of the median Dark</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">median_val</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                            <span class="n">vmin</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">median_val</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">median_val</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">ma</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">median_val</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Median Dark for Dark database&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

    <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_01-Calibrations_20_0.png" src="../_images/notebooks_01-Calibrations_20_0.png" />
</div>
</div>
<div class="section" id="3.-Flats">
<h3>3. Flats<a class="headerlink" href="#3.-Flats" title="Permalink to this headline">¶</a></h3>
<p>We need to subtract the Master Bias from the flats, before we combine them.</p>
</div>
<div class="section" id="3.a-The-cell-below-will-create-a-PDF-of-all-the-FLATS-for-inspection">
<h3>3.a The cell below will create a PDF of all the FLATS for inspection<a class="headerlink" href="#3.a-The-cell-below-will-create-a-PDF-of-all-the-FLATS-for-inspection" title="Permalink to this headline">¶</a></h3>
<p>Flat images should look like this:</p>
<p><img alt="9b949e66d89342c68f065d3ad3b73ea1" class="no-scaled-link" src="../_images/FlatExample.png" style="width: 600px;" /></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##########</span>
<span class="c1"># Cell to change</span>
<span class="c1">##########</span>

<span class="n">image_number</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">image_number</span><span class="p">)</span>
<span class="n">all_filename</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/Flat/Flat-</span><span class="si">{:03}</span><span class="s1">.fit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">image_number</span><span class="p">]</span>

<span class="c1">#print(all_filename)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">toSubtract</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/MasterBias.dump&#39;</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">### this line loads masterBias into the toSubtract variable.</span>
<span class="c1">### make sure you have the right filename</span>
<span class="c1">###################</span>
<span class="c1"># nothing to change below</span>

<span class="n">image_median</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">PdfPages</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/Flat_all.pdf&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pdf</span><span class="p">:</span>

    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">all_filename</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">name</span><span class="p">))</span><span class="o">-</span><span class="n">toSubtract</span> <span class="c1">## this is where the subtraction is</span>
        <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">data</span><span class="p">[:,</span><span class="n">right</span><span class="p">:</span><span class="n">length</span><span class="p">]</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                        <span class="n">vmin</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">ma</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">image_median</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="n">image_median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">image_median</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">image_median</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span><span class="o">*</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1">## Add labels to the figure below</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1327.0, 4910.25)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_01-Calibrations_24_1.png" src="../_images/notebooks_01-Calibrations_24_1.png" />
</div>
</div>
</div>
<div class="section" id="3.b-Now-that-you-have-inspected-all-the-flats,-as-long-as-they-are-okay,-make-a-finale-selection-below-and-create-Master-file-for-each-exposure-times">
<h3>3.b Now that you have inspected all the flats, as long as they are okay, make a finale selection below and create Master file for each exposure times<a class="headerlink" href="#3.b-Now-that-you-have-inspected-all-the-flats,-as-long-as-they-are-okay,-make-a-finale-selection-below-and-create-Master-file-for-each-exposure-times" title="Permalink to this headline">¶</a></h3>
<p>Note: you will have to execute the cell below for each exposure time group.</p>
<p>Please add the exposure time in the output name for the flat.</p>
<p>Keep all of the commands you’ve use (commented out) for the records</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">toSubtract</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/MasterBias.dump&#39;</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Make sure the the file name is still right:</span>


<span class="n">output_name</span><span class="o">=</span><span class="s1">&#39;MasterFlat_0.15&#39;</span>
<span class="n">image_number_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">all_filename_final</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/Flat/Flat-</span><span class="si">{:03}</span><span class="s1">.fit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">image_number_final</span><span class="p">]</span>

<span class="c1">#output_name=&#39;MasterFlat_0.25&#39;</span>
<span class="c1">#image_number_final = np.arange(12,23,1)</span>
<span class="c1">#all_filename_final = [&#39;{}/Flat/Flat-{:03}.fit&#39;.format(path, item) for item in image_number_final]</span>


<span class="c1">##############</span>
<span class="c1">##############</span>
<span class="c1"># nothing to change below</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_filename_final</span><span class="p">),</span><span class="n">width</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_filename_final</span><span class="p">):</span>
    <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">name</span><span class="p">))</span><span class="o">-</span><span class="n">toSubtract</span> <span class="c1">## this is where the subtraction is</span>
    <span class="n">data</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">:</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
    <span class="n">data</span><span class="p">[:,:,</span><span class="n">right</span><span class="p">:</span><span class="n">length</span><span class="p">]</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

<span class="n">median_val</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">## remasking the array:</span>
<span class="n">median_val</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
<span class="n">median_val</span><span class="p">[:,</span><span class="n">right</span><span class="p">:</span><span class="n">length</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

<span class="n">median_val</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/</span><span class="si">{}</span><span class="s1">.dump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_name</span><span class="p">)</span> <span class="p">)</span>

<span class="k">with</span> <span class="n">PdfPages</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_name</span><span class="p">))</span> <span class="k">as</span> <span class="n">pdf</span><span class="p">:</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">median_val</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                            <span class="n">vmin</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">median_val</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">median_val</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">ma</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">median_val</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">output_name</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_01-Calibrations_26_0.png" src="../_images/notebooks_01-Calibrations_26_0.png" />
</div>
</div>
</div>
<div class="section" id="4.-THARs">
<h3>4. THARs<a class="headerlink" href="#4.-THARs" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="4.a-The-cell-below-will-create-a-PDF-of-all-the-ThAr-for-inspection">
<h3>4.a The cell below will create a PDF of all the ThAr for inspection<a class="headerlink" href="#4.a-The-cell-below-will-create-a-PDF-of-all-the-ThAr-for-inspection" title="Permalink to this headline">¶</a></h3>
<p>ThAr images should look like this:</p>
<p><img alt="02d4243dd7f64ba69f59a2a8df0a9566" class="no-scaled-link" src="../_images/ThArExample.png" style="width: 600px;" /></p>
<p>The cell below creates an array with the filenames of all the ThAr.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##########</span>
<span class="c1"># Cell to change</span>
<span class="c1">##########</span>

<span class="n">image_number</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">early_filename</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/ThAr/early/Th-Ar-</span><span class="si">{:03}</span><span class="s1">.fit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">image_number</span><span class="p">]</span>

<span class="n">image_number</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">late_filename</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/ThAr/late/Th-Ar-2nd-</span><span class="si">{:03}</span><span class="s1">.fit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">image_number</span><span class="p">]</span>

<span class="n">all_filename</span><span class="o">=</span><span class="n">early_filename</span><span class="o">+</span><span class="n">late_filename</span>

<span class="c1">#print(all_filename)</span>
</pre></div>
</div>
</div>
<p>The cell below creates a PDF with an image of all the ThAr</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">toSubtract</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/MasterBias.dump&#39;</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Make sure the the file name is still right:</span>


<span class="c1">##############</span>
<span class="c1">##############</span>
<span class="c1"># nothing to change below</span>

<span class="n">image_median</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">PdfPages</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/ThAr_all.pdf&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pdf</span><span class="p">:</span>

    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">all_filename</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">name</span><span class="p">))</span><span class="o">-</span><span class="n">toSubtract</span>
        <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">data</span><span class="p">[:,</span><span class="n">right</span><span class="p">:</span><span class="n">length</span><span class="p">]</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                        <span class="n">vmin</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">ma</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">image_median</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="n">image_median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">image_median</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">image_median</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">image_median</span><span class="p">)</span><span class="o">*</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1">## Add labels to the figure below</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(28.666666666666668, 110.25)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_01-Calibrations_32_1.png" src="../_images/notebooks_01-Calibrations_32_1.png" />
</div>
</div>
</div>
<div class="section" id="5.b-Now-that-you-have-inspected-all-the-ThArs,-as-long-as-they-are-okay,-make-a-finale-selection-below-and-create-Master-file">
<h3>5.b Now that you have inspected all the ThArs, as long as they are okay, make a finale selection below and create Master file<a class="headerlink" href="#5.b-Now-that-you-have-inspected-all-the-ThArs,-as-long-as-they-are-okay,-make-a-finale-selection-below-and-create-Master-file" title="Permalink to this headline">¶</a></h3>
<p>Note: you will have to execute the cell below for each exposure time group.</p>
<p>Keep all of the commands you’ve use (commented out) for the records</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">toSubtract</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/MasterBias.dump&#39;</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Make sure the the file name is still right:</span>

<span class="c1">#output_name=&#39;MasterThAr_1&#39;</span>
<span class="c1">#all_filename_final = [&#39;{}ThAr-Spec-20200113-{:03}.fit&#39;.format(path, item) for item in range(1,6)]</span>

<span class="c1">#output_name=&#39;MasterThAr_2&#39;</span>
<span class="c1">#all_filename_final = [&#39;{}ThAr-Spec-20200113-{:03}.fit&#39;.format(path, item) for item in range(6,11)]</span>

<span class="c1">#output_name=&#39;MasterThAr_3&#39;</span>
<span class="c1">#all_filename_final = [&#39;{}ThAr-Spec-20200113-{:03}.fit&#39;.format(path, item) for item in range(11,16)]</span>

<span class="c1">#output_name=&#39;MasterThAr_4&#39;</span>
<span class="c1">#all_filename_final = [&#39;{}ThAr-Spec-20200113-{:03}.fit&#39;.format(path, item) for item in range(16,21)]</span>

<span class="c1">#output_name=&#39;MasterThAr_5&#39;</span>
<span class="c1">#all_filename_final = [&#39;{}ThAr-Spec-20200113-{:03}.fit&#39;.format(path, item) for item in range(21,26)]</span>

<span class="n">output_name</span><span class="o">=</span><span class="s1">&#39;MasterThAr_6&#39;</span>
<span class="n">all_filename_final</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">ThAr-Spec-20200113-</span><span class="si">{:03}</span><span class="s1">.fit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="mi">31</span><span class="p">)]</span>


<span class="c1">####create the above code for Thars taken in the same time frame</span>
<span class="c1">###apply that piece of code to all of them in the same cell five times</span>

<span class="c1">#############</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_filename_final</span><span class="p">),</span><span class="n">width</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_filename_final</span><span class="p">):</span>
    <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">name</span><span class="p">))</span><span class="o">-</span><span class="n">toSubtract</span>
    <span class="n">data</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">:</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
    <span class="n">data</span><span class="p">[:,:,</span><span class="n">right</span><span class="p">:</span><span class="n">length</span><span class="p">]</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>


<span class="n">median_val</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">## remasking the array:</span>
<span class="n">median_val</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
<span class="n">median_val</span><span class="p">[:,</span><span class="n">right</span><span class="p">:</span><span class="n">length</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

<span class="n">median_val</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/</span><span class="si">{}</span><span class="s1">.dump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_name</span><span class="p">))</span>

<span class="k">with</span> <span class="n">PdfPages</span><span class="p">(</span><span class="s1">&#39;01-CalibrationMasters/</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_name</span><span class="p">))</span> <span class="k">as</span> <span class="n">pdf</span><span class="p">:</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">median_val</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                            <span class="n">vmin</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">median_val</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">median_val</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">ma</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">median_val</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">output_name</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/early/Th-Ar-001.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/early/Th-Ar-002.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/early/Th-Ar-003.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/early/Th-Ar-004.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/early/Th-Ar-005.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/early/Th-Ar-006.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/early/Th-Ar-007.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/early/Th-Ar-008.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/early/Th-Ar-009.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/early/Th-Ar-010.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/late/Th-Ar-2nd-001.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/late/Th-Ar-2nd-002.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/late/Th-Ar-2nd-003.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/late/Th-Ar-2nd-004.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/late/Th-Ar-2nd-005.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/late/Th-Ar-2nd-006.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/late/Th-Ar-2nd-007.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/late/Th-Ar-2nd-008.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/late/Th-Ar-2nd-009.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/late/Th-Ar-2nd-010.fit&#39;, &#39;/Users/keefekamp/FIT/SpectraTest/TestDataset/ThAr/late/Th-Ar-2nd-011.fit&#39;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_01-Calibrations_34_1.png" src="../_images/notebooks_01-Calibrations_34_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../API.html" class="btn btn-neutral float-right" title="sara-spec" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../index.html" class="btn btn-neutral float-left" title="Welcome to sara-spec documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, V. Petit.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>